  <div class="title">
    <mat-card-title>הוסף בעל חיים</mat-card-title>
  </div>

    <div class="container">
      <!--Add pet form starts-->
      <form [formGroup]="addPetFormGroup" #addPetForm="ngForm" [hidden]="formUploaded">
        <mat-vertical-stepper dir="rtl" #stepper [linear]="true" formArrayName="formArray">
          <mat-step formGroupName="0" [stepControl]="formArray?.get([0])!" label="בחר סוג חיה" state="type">
            <!--Select animal type-->
            <div class="row">
              <mat-form-field appearance="outline">
                <mat-label>סוג</mat-label>
                <mat-select #typeSel placeholder="בחר סוג" name="animalType" formControlName="animalType"
                  (selectionChange)="loadUniqueTraits($event)">
                  <mat-option *ngFor="let type of animaltypes_arr" [value]="type.id">
                    {{ type.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <button class="next-button" mat-button matStepperNext>הבא</button>
          </mat-step>

          <mat-step formGroupName="1" [stepControl]="formArray?.get([1])!" label="פרטי החיה" state="details">
            <!--Insert pet name-->
              <div class="pet-details">
                <div class="input-box">
                  <mat-form-field hintLabel="מקסימום 10 תווים" appearance="outline" id="name">
                    <mat-label>שם</mat-label>
                    <input #petName maxlength="10" formControlName="petName" matInput name="name" placeholder="שם"
                      required />
                    <mat-hint align="end">{{petName.value?.length || 0}}/10</mat-hint>
                  </mat-form-field>
                </div>
                
                <!--Select date of birth-->
                <div class="input-box">
                  <mat-form-field appearance="outline" id="bd">
                    <mat-label>תאריך לידה</mat-label>
                    <mat-hint>*ניתן למלא תאריך לידה משוער</mat-hint>
                    <input formControlName="dob" matInput [min]="minDate" [max]="maxDate" [matDatepicker]="picker" />
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                  </mat-form-field>
                </div>

                <!--Select gender-->
                <div class="input-box gender-radio-group">
                  <mat-label>מין</mat-label>
                  <mat-radio-group formControlName="gender" class="margin-left">
                    <mat-radio-button class="gender-button" *ngFor="let gender of gender_arr; index as id" [value]=id> 
                      {{gender}}
                    </mat-radio-button>
                  </mat-radio-group>
                </div>

                <!--Unique traits for chosen animal type-->
                <div class="traits-chips">
                  <mat-label>בחר תכונות מיוחדות:</mat-label>
                  <app-chips-multi-select #chips [options]="traitsWithBooleanValue"
                    [isMatChipsTraitsLoaded]="isMatChipsLoaded" (data)="eventHandler($event)"
                    formControlName="chipsControl">
                  </app-chips-multi-select>
                </div>

                <div class="input-box" *ngFor="let trait of traitsWithSetOfValues">

                  <app-select [trait]="trait" (selectionEvent)="onTraitSelection($event)"></app-select>

                </div>

                <!--Some more details about the pet-->
                <div class="input-box">
                  <mat-form-field appearance="outline">
                    <textarea matInput style="width: 300px;" placeholder="תיאור נוסף" formControlName="description"
                      cdkTextareaAutosize cdkAutosizeMinRows="5" cdkAutosizeMaxRows="10">
                    </textarea>
                  </mat-form-field>
                </div>
                <button class="next-button" mat-button matStepperNext>הבא</button>
              </div>
          </mat-step>

          <mat-step formGroupName="2" label="הוספת תמונות" [optional]="true" state="pictures">
            <!--Image upload-->
            <div class="row">
              <div>
                <app-file-uploader #fileuploader></app-file-uploader>
              </div>
              <div>
                <app-file-uploader #fileuploader></app-file-uploader>
              </div>
              <div>
                <app-file-uploader #fileuploader></app-file-uploader>
              </div>
            </div>
            <button class="next-button" mat-button matStepperNext>הבא</button>
          </mat-step>

          <mat-step formGroupName="3" [stepControl]="formArray?.get([3])!" label="סיום ושליחה" state="send">
            <div class="row">
              <!--submit button-->
              <div class="row">
                <button mat-button color="primary" type="submit" (click)="onSubmit(addPetForm.value)">שלח</button>
              </div>
            </div>
            <button mat-button matStepperPrevious>הקודם</button>
          </mat-step>

          <!-- Icon overrides. -->
          <ng-template matStepperIcon="type">
            <mat-icon>pets</mat-icon>
          </ng-template>
          <ng-template matStepperIcon="details">
            <mat-icon>list_alt</mat-icon>
          </ng-template>
          <ng-template matStepperIcon="pictures">
            <mat-icon>camera_alt</mat-icon>
          </ng-template>
          <ng-template matStepperIcon="send">
            <mat-icon>send</mat-icon>
          </ng-template>

        </mat-vertical-stepper>
      </form>
    </div>
    <!--Add pet form ends-->

    <div *ngIf="formUploaded" class="notification is-success">
      <div *ngIf="success; else failed">
        <div>
          בעל החיים הוסף בהצלחה!
        </div>
        <div>
          <a routerLink="/">חזרו לעמוד הראשי</a>
        </div>
      </div>
      <ng-template #failed>
        <div>
          אנחנו מצטערים:( חלה שגיאה בהעלאת בעל החיים.
          אנא
          <a routerLink="/pets/add">נסו שוב</a>
          או
          <a routerLink="/">חזרו לעמוד הראשי</a>
        </div>
      </ng-template>
    </div>


    <!-- <div *ngIf="success; else failed" class="notification is-success">
      <div>
        בעל החיים הוסף בהצלחה!
      </div>
      <div>
        <a routerLink="/">חזרו לעמוד הראשי</a>
      </div>
    </div>
    <ng-template #failed>
      <div>
        אנחנו מצטערים:( חלה שגיאה בהעלאת בעל החיים.
        אנא
        <a routerLink="/pets/add">נסו שוב</a>
        או
        <a routerLink="/">חזרו לעמוד הראשי</a>
      </div>
    </ng-template> -->